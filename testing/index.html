<!DOCTYPE html>
<html lang="en">
<head>
    <title>Юнит тестирование для ленивых</title>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../shower/themes/ribbon/styles/screen-16x10.css">
    <style type="text/css">
        .pad {
            padding-left: 50px;
        }
    </style>
</head>
<body class="shower list">
    <header class="caption">
        <h1>Юнит тестирование для ленивых</h1>
        <p>Владимир Дашукевич</p>
    </header>
    <section class="slide cover">
        <img src="pictures/6.jpg" alt="" class="cover">	
    </section>
    <section class="slide cover">
        <img src="pictures/1.png" alt="" class="cover">	
    </section>
    <section class="slide">
        <h2>Вопросы:</h2>
        <ol>
            <li>Как правильно писать юнит тесты?</li>
            <li class="next">Как увеличить эффиктивность юнит тестов?</li>
            <li class="next">Как ускорить написание юнит тестов?</li>
            <li class="next">Что в процессе написания юнит тестов можно автоматизировать?</li>
        </ol>
    </section>
    <section class="slide">
        <img src="pictures/1.jpg" alt="" class="cover h">
    </section>
    <section class="slide black">
        <img src="pictures/2.png" alt="" class="cover w">
    </section>
    <section class="slide black">
        <img src="pictures/4.png" alt="" class="cover h">
    </section>
    <section class="slide black">
        <img src="pictures/5.png" alt="" class="cover h">
    </section>
    <section class="slide black">
        <img src="pictures/3.png" alt="" class="cover w">
    </section>
    <section class="slide">
        <h2 class="shout" style="font-size: 5em;">Автоматизировать написание юнит тестов</h2>
    </section>
    <section class="slide">
        <h2>Части</h2>
        <ol>
            <li>Теория</li>
            <li>Практика</li>
            <li>Эксперименты</li>
        </ol>
    </section>
    <section class="slide">
        <h2 class="shout">Теория</h2>
    </section>
    <section class="slide">
        <h2 class="shout">Что такое юнит тест?</h2>
    </section>
    <section class="slide">
        <figure>
            <blockquote>
                <p>Модульное тестирование, или юнит-тестирование — процесс в программировании, позволяющий проверить на корректность отдельные модули исходного кода программы.</p>
            </blockquote>
            <figcaption>Wikipedia</figcaption>
        </figure>
    </section>
    <section class="slide">
        <h2>Части юнит теста</h2>
        <ol>
            <li class="next">Код модуля</li>
            <li class="next">Входные данные</li>
            <li class="next">Код теста</li>
        </ol>
    </section>
    <section class="slide">
        <h2>Сложный алгоритм:</h2>
        <pre>
            <code><span class="comment">// ???</span></code>
            <code>var add = function (a, b) {</code>
            <code>	return a + b;</code>
            <code>}</code>
        </pre>
    </section>
    <section class="slide">
        <h2>Сложный алгоритм:</h2>
        <pre>
            <code><span class="comment">//a = 1, b = 2</span></code>
            <code>var add = function (a, b) {</code>
            <code>	return a + b;</code>
            <code>}</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Сложный тест:</h2>
        <pre>
            <code>test('adds 1 + 2 to equal 3', () => {</code>
            <code>	expect(add(1, 2)).toBe(3);</code>
            <code>});</code>
        </pre>
    </section>

    <section class="slide">
        <h2 class="shout">Достаточно ли данного теста?</h2>
    </section>

    <section class="slide">
        <h2>Сложный алгоритм:</h2>
        <pre>
            <code><span class="comment">//a = -1, b = -2</span></code>
            <code>var add = function (a, b) {</code>
            <code>	return a + b;</code>
            <code>}</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Сложный алгоритм:</h2>
        <pre>
            <code><span class="comment">//a = Number.MAX_VALUE, b = Number.MIN_VALUE</span></code>
            <code>var add = function (a, b) {</code>
            <code>	return a + b;</code>
            <code>}</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Сложный алгоритм:</h2>
        <pre>
            <code><span class="comment">//a = null, b = null</span></code>
            <code>var add = function (a, b) {</code>
            <code>	return a + b;</code>
            <code>}</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Сложный алгоритм:</h2>
        <pre>
            <code><span class="comment">//a = null, b = null</span></code>
            <code>var add = function (a, b) {</code>
            <code>	return a + b;<span class="comment">// <mark class="important">NaN</mark></span></code>
            <code>}</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Сложный алгоритм:</h2>
        <pre>
            <code><span class="comment">//a = null, b = null</span></code>
            <code>var add = function (a: <mark>number</mark>, b: <mark>number</mark>) {</code>
            <code>	return a + b;<span class="comment">// NaN</span></code>
            <code>}</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Сложный алгоритм:</h2>
        <pre>
            <code><span class="comment">//a = null, b = null</span></code>
            <code>var add = function (a, b) {</code>
            <code>	if (a === null || b === null) {</code>
            <code>		throw Error("Wrong arguments");</code>
            <code>	}</code>
            <code>	return a + b;</code>
            <code>}</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Сложный тест:</h2>
        <pre>
            <code>test("Check errors", () => {</code>
            <code>	expect(() => add(null, null))</code>
            <code>		.toThrowError("Wrong arguments");</code>
            <code>});</code>
        </pre>
    </section>

    <section class="slide">
        <h2 class="shout">Тестируйте только то, что нужно</h2>
    </section>

    <section class="slide">
        <h2 class="shout">А что нужно тестировать?</h2>
    </section>

    <section class="slide">
        <h2>Сложный алгоритм:</h2>
        <pre>
            <code><span class="comment">//a = null, b = null</span></code>
            <code>var add = function (a, b) {</code>
            <code>	if (a === null || b === null) {</code>
            <code>		throw Error("Wrong arguments");</code>
            <code>	}</code>
            <code>	return a + b;</code>
            <code>}</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Сложный алгоритм:</h2>
        <pre>
            <code><span class="comment">//a = null, b = null</span></code>
            <code>var add = function (a, b) {</code>
            <code>	if (a === null || b === null) {</code>
            <code>		throw Error("Wrong arguments");</code>
            <code>	}</code>
            <code>	<mark>return a + b;</mark></code>
            <code>}</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Сложный алгоритм:</h2>
        <pre>
            <code><span class="comment">//a = null, b = null</span></code>
            <code>var add = function (a, b) {</code>
            <code>	if (a === null || b === null) {</code>
            <code>		<mark>throw Error("Wrong arguments");</mark></code>
            <code>	}</code>
            <code>	<mark>return a + b;</mark></code>
            <code>}</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Измерение покрытия кода тестами</h2>
        <ol>
            <li><a href="https://istanbul.js.org/">Istanbuljs</a></li>
            <li><a href="http://blanketjs.org/">Blanketjs</a></li>
        </ol>
    </section>

    <section class="slide black">
        <img src="pictures/8.png" alt="" class="cover w">
    </section>

    <section class="slide">
        <h2 class="shout">Достаточно ли этих тестов?</h2>
    </section>

    <section class="slide">
        <h2 class="shout">Twitter для староверов</h2>
    </section>

    <section class="slide">
        <h2 class="shout">Свидетели 140 символов</h2>
    </section>

    <section class="slide">
        <h2>Сложный алгоритм:</h2>
        <pre>
            <code>var shorten = function (str: string): string {</code>
            <code>	return str.substring(0, 140);</code>
            <code>}</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Сложный алгоритм:</h2>
        <pre>
            <code>var shorten = function (str: <mark>string</mark>): <mark>string</mark> {</code>
            <code>	return str.substring(0, 140);</code>
            <code>}</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Сложный тест:</h2>
        <pre>
            <code>test("Shorten long string", () => {</code>
            <code>	const twit = "Dear, Twitter ....";</code>
            <code>	expect(shorten(twit))</code>
            <code>		.toBe(twit.substring(0, 140));</code>
            <code>});</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Сложный тест 2:</h2>
        <pre>
            <code>test("Shorten long string", () => {</code>
            <code>	const twit = "Dear, Twitter";</code>
            <code>	expect(shorten(twit))</code>
            <code>		.toBe(twit);</code>
            <code>});</code>
        </pre>
    </section>

    <section class="slide black">
        <img src="pictures/9.png" alt="" class="cover w">
    </section>


    <section class="slide">
        <h2>Используем:</h2>
        <pre>
            <code>shorten("Dear, Hipster, .... 😁")</code>
            <code class="next">shorten("Dear, Apple, .... 💩")</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Ох уже этот юникод:</h2>
        <pre>
            <code>"😁".length === 2</code>
            <code>"💩".length === 2</code>
        </pre>
    </section>
    
    <section class="slide">
        <h2>Используем:</h2>
        <pre>
            <code>shorten("Dear, Hipster, .... 😁");</code>
            <code><span class="comment">// "Dear, Hipster, .... ???"</span></code>
            <code>shorten("Dear, Apple, .... 💩");</code>
            <code><span class="comment">// "Dear, Apple, .... ???"</span></code>
        </pre>
    </section>

    <section class="slide">
        <h2 class="shout">Классы эквивалентности</h2>
    </section>

    <section class="slide">
        <figure>
            <blockquote>
                <p>Классы эквивалентности — области, внутри которых значения эквивалентны друг другу. Тестирование одного значения приводит к тому же результату, что и тестирование другого.</p>
            </blockquote>
            <figcaption>testbase.ru</figcaption>
        </figure>
    </section>

    <section class="slide">
        <h2>Шаги написания юнит тестов</h2>
        <ol>
            <li class="next">Узнать облать определения функции</li>
            <li class="next">Разделить на классы эквивалентности</li>
            <li class="next">Взять из каждого класса по одному экземпляру</li>
            <li class="next">Проверить граничные условия</li>
        </ol>
    </section>

    <section class="slide">
        <h2 class="shout" style="font-size: 5em;">Как бы это автоматизировать?</h2>
    </section>

    <section class="slide">
        <h2 class="shout">Практика</h2>
    </section>

    <section class="slide">
        <h2 class="shout">Выбор тестового фреймворка?</h2>
    </section>

    <section class="slide black">
        <img src="pictures/1.gif" alt="" class="cover h">
    </section>

    <section class="slide">
        <h2>Тестовые фреймворки</h2>
        <ol>
            <li>QUnit</li>
            <li>Mocha</li>
            <li>Jasmin</li>
            <li>Tape</li>
            <li>Jest</li>
        </ol>
    </section>
    <section class="slide">
        <h2 class="shout">Они все одинаковы!</h2>
    </section>

    <section class="slide">
        <h2>Части модульного теста</h2>
        <ol>
            <li>Код модуля</li>
            <li>Входные данные</li>
            <li>Код теста</li>
        </ol>
    </section>

    <section class="slide">
        <h2>Части модульного теста</h2>
        <ol>
            <li>Код модуля</li>
            <li><mark>Входные данные</mark></li>
            <li>Код теста</li>
        </ol>
    </section>

    <section class="slide">
        <h2 class="shout">Property-based testing</h2>
    </section>

    <section class="slide">
        <h2>Property-based testing</h2>
        <ol>
            <li>Описание входных данных</li>
            <li>Описание проверки выходных данных</li>
        </ol>
    </section>

    <section class="slide">
        <h2 class="shout" style="font-size: 5em;">Написать рандомный генератор данных</h2>
    </section>

    <section class="slide">
        <h2>Генератор чисел:</h2>
        <pre>
            <code>var posNumber = function () {</code>
            <code>	return Math.random() * 10000000000;</code>
            <code>}</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Генераторы данных</h2>
        <ol>
            <li><a href="https://github.com/marak/Faker.js/">faker.js</a></li>
            <li><a href="https://github.com/icebob/fakerator">fakerator</a></li>
            <li><a href="https://github.com/boo1ean/casual">casual</a></li>
        </ol>
    </section>

    <section class="slide">
        <h2>Генератор данных:</h2>
        <pre>
            <code>faker.name.findName();</code>
            <code><span class="comment">// Rowan Nikolaus</span></code>
            <code>faker.internet.email();</code>
            <code><span class="comment">// Kassandra.Haley@erich.biz</span></code>
            <code>faker.helpers.createCard();</code>
            <code>faker.helpers.userCard();</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Недостатки</h2>
        <ol>
            <li>Нужно писать код для правильной генерации данных</li>
            <li class="next">Нужно контролировать генерируемые данные</li>
            <li class="next">Нужно продумывать граничные условия</li>
        </ol>
    </section>

    <section class="slide">
        <h2 class="shout">Использовать библиотеки</h2>
    </section>

    <section class="slide">
        <h2>Библиотеки</h2>
        <ol>
            <li><a href="https://github.com/leebyron/testcheck-js">TestCheck</a></li>
            <li><a href="https://github.com/jsverify/jsverify">jsVerify</a></li>
        </ol>
    </section>

    <section class="slide">
        <h2>Сложный алгоритм:</h2>
        <pre>
            <code>var add = function (a: number, b: number): number {</code>
            <code>	return a + b;</code>
            <code>}</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Сложный тест:</h2>
        <pre>
            <code>test('adds numbers', () => {</code>
            <code>	check(property(</code>
            <code>		[gen.number, gen.number],</code>
            <code>		(a, b) => add(a, b) === a + b</code>
            <code>	));</code>
            <code>});</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Сложный тест:</h2>
        <pre>
            <code>test('adds numbers', () => {</code>
            <code>	<mark>check</mark>(property(</code>
            <code>		[gen.number, gen.number],</code>
            <code>		(a, b) => add(a, b) === a + b</code>
            <code>	));</code>
            <code>});</code>
        </pre>
    </section>

        <section class="slide">
        <h2>Сложный тест:</h2>
        <pre>
            <code>test('adds numbers', () => {</code>
            <code>	check(<mark>property</mark>(</code>
            <code>		[gen.number, gen.number],</code>
            <code>		(a, b) => add(a, b) === a + b</code>
            <code>	));</code>
            <code>});</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Сложный тест:</h2>
        <pre>
            <code>test('adds numbers', () => {</code>
            <code>	check(property(</code>
            <code>		<mark>[gen.number, gen.number]</mark>,</code>
            <code>		(a, b) => add(a, b) === a + b</code>
            <code>	));</code>
            <code>});</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Сложный тест:</h2>
        <pre>
            <code>test('adds numbers', () => {</code>
            <code>	check(property(</code>
            <code>		[gen.number, gen.number],</code>
            <code>		(a, b) => <mark>add(a, b) === a + b</mark></code>
            <code>	));</code>
            <code>});</code>
        </pre>
    </section>

    <section class="slide">
        <h2 class="shout" style="font-size: 5em;">Тестируйте только то, что нужно</h2>
    </section>

    <section class="slide">
        <h2 class="shout" style="font-size: 5em;"><mark>Генерируйте</mark> только то, что нужно</h2>
    </section>

    <section class="slide">
        <h2>Типы</h2>
        <ol>
            <li>posNumber, negNumber, numberWithin, int, posInt и так далее</li>
            <li>string, asciiString и так далее</li>
            <li>array, uniqueArray, object</li>
            <li>JSON</li>
        </ol>
    </section>

    <section class="slide">
        <h2 class="shout">Сложные типы</h2>
    </section>

    <section class="slide">
        <h2>Пользователь</h2>
        <ol>
            <li>ФИО</li>
            <li>Права доступа</li>
            <li>Статьи</li>
            <ol>
                <li>Название</li>
                <li>Текст</li>
                <li>Оценка</li>
            </ol>
        </ol>
    </section>

    <section class="slide">
        <h2>ФИО:</h2>
        <pre>
            <code>var fio = gen.object({</code>
            <code>	firstname: gen.oneOf([gen.string, gen.undefined]),</code>
            <code>	lastname: gen.oneOf([gen.string, gen.undefined]),</code>
            <code>	middlename: gen.oneOf([gen.string, gen.undefined])</code>
            <code>});</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Права доступа:</h2>
        <pre>
            <code>var rights = gen.oneOf(['Администратор',</code>
            <code>					'Пользователь',</code>
            <code>					'Наблюдатель',</code>
            <code>					'Незнакомец'])</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Статья:</h2>
        <pre>
            <code>var article = gen.object({</code>
            <code>	title: gen.string,</code>
            <code>	content: gen.string,</code>
            <code>	score: gen.int</code>
            <code>});</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Пользователь:</h2>
        <pre>
            <code>var user = gen.object({</code>
            <code>	fio,</code>
            <code>	rights,</code>
            <code>	articles: gen.array(article)</code>
            <code>});</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Генерация пользователя:</h2>
        <pre>
            <code>JSON.stringify(sample(user, 4), null, "\t")</code>
        </pre>
    </section>

    <section class="slide">
        <pre>
            <code>{ "fio": {</code>
            <code>		"firstname": "h",</code>
            <code>		"lastname": "Ók!"</code>
            <code>	},</code>
            <code>	"rights": "Наблюдатель",</code>
            <code>	"articles": [{</code>
            <code>		"title": "j",</code>
            <code>		"content": "X9",</code>
            <code>		"score": -3</code>
            <code>}] }</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Запуск тестов</h2>
        <ol>
            <li>jsVerify + mocha, jasmine, tape</li>
            <li class="next">TestCheck + mocha, jasmine, tape</li>
            <li class="next">mocha-check</li>
            <li class="next">jasmine-check</li>
            <li class="next">tape-check</li>
        </ol>
    </section>

    <section class="slide">
        <h2>Тест с tape</h2>
        <pre>
            <code>const test = require('tape');</code>
            <code>const { check } = require('tape-check');</code>
            <code>test('Test 1', check(article, (t, state) => {</code>
            <code>	t.plan(1);</code>
            <code>	t.equal(state, reducer(</code>
            <code>			reducer(state, { type: INC })</code>
            <code>			{ type: DEC }</code>
            <code>	));</code>
            <code>}));</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Тест с tape</h2>
        <pre>
            <code>const test = require('tape');</code>
            <code>const { <mark>check</mark> } = require('tape-check');</code>
            <code>test('Test 1', <mark>check</mark>(article, (t, state) => {</code>
            <code>	t.plan(1);</code>
            <code>	t.equal(state, reducer(</code>
            <code>			reducer(state, { type: INC })</code>
            <code>			{ type: DEC }</code>
            <code>	));</code>
            <code>}));</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Тест с tape</h2>
        <pre>
            <code>const test = require('tape');</code>
            <code>const { check } = require('tape-check');</code>
            <code>test('Test 1', check(<mark>article</mark>, (t, <mark>state</mark>) => {</code>
            <code>	t.plan(1);</code>
            <code>	t.equal(state, reducer(</code>
            <code>			reducer(state, { type: INC })</code>
            <code>			{ type: DEC }</code>
            <code>	));</code>
            <code>}));</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Тест с tape</h2>
        <pre>
            <code>const test = require('tape');</code>
            <code>const { check } = require('tape-check');</code>
            <code>test('Test 1', check(article, (t, state) => {</code>
            <code>	t.plan(1);</code>
            <code>	t.equal(state, reducer(</code>
            <code>			<mark>reducer(state, { type: INC })</mark></code>
            <code>			{ type: DEC }</code>
            <code>	));</code>
            <code>}));</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Тест с tape</h2>
        <pre>
            <code>const test = require('tape');</code>
            <code>const { check } = require('tape-check');</code>
            <code>test('Test 1', check(article, (t, state) => {</code>
            <code>	t.plan(1);</code>
            <code>	t.equal(state, <mark>reducer(</mark></code>
            <code>			reducer(state, { type: INC })</code>
            <code>			<mark>{ type: DEC }</mark></code>
            <code>	));</code>
            <code>}));</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Тест с tape</h2>
        <pre>
            <code>const test = require('tape');</code>
            <code>const { check } = require('tape-check');</code>
            <code>test('Test 1', check(article, (t, state) => {</code>
            <code>	t.plan(1);</code>
            <code>	<mark>t.equal(state</mark>, reducer(</code>
            <code>			reducer(state, { type: INC })</code>
            <code>			{ type: DEC }</code>
            <code>	));</code>
            <code>}));</code>
        </pre>
    </section>

    <section class="slide">
        <h2 class="shout">Passed</h2>
    </section>

    <section class="slide">
        <h2>Тест с tape</h2>
        <pre>
            <code>test('Test 1', check(article, (t, state) => {</code>
            <code>	t.plan(1);</code>
            <code>	t.ok(</code>
            <code>		state.score &lt; reducer(state, { type: INC }).score</code>
            <code>	);</code>
            <code>}));</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Тест с tape</h2>
        <pre>
            <code>test('Test 1', check(article, (t, state) => {</code>
            <code>	t.plan(1);</code>
            <code>	t.ok(</code>
            <code>		state.score &lt; reducer(state, <mark>{ type: INC }</mark>).score</code>
            <code>	);</code>
            <code>}));</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Тест с tape</h2>
        <pre>
            <code>test('Test 1', check(article, (t, state) => {</code>
            <code>	t.plan(1);</code>
            <code>	t.ok(</code>
            <code>		<mark>state.score &lt;</mark> reducer(state, { type: INC }).score</code>
            <code>	);</code>
            <code>}));</code>
        </pre>
    </section>

    <section class="slide">
        <h2 class="shout">Failed</h2>
    </section>

    <section class="slide">
        <h2>Результаты:</h2>
        <ol>
            <li>{ title: 'M', content: '', score: 9007199254740992 }</li>
        </ol>
    </section>

    <section class="slide">
        <h2>Результаты:</h2>
        <ol>
            <li>{ title: 'M', content: '', score: <mark>9007199254740992</mark> }</li>
        </ol>
    </section>

    <section class="slide">
        <h2>Результаты:</h2>
        <ol>
            <li>Number.MAX_SAFE_INTEGER + 1</li>
            <li>9007199254740992 + 1 // 9007199254740992</li>
        </ol>
    </section>

    <section class="slide">
        <h2 class="shout">Вычисление ошибки (Shrink)</h2>
    </section>

    <section class="slide">
        <h2>Вычисление ошибки</h2>
        <pre>
            <code>shrunk: {</code>
            <code>	depth: 1,</code>
            <code>	result: false,</code>
            <code>	totalNodesVisited: 2,</code>
            <code>	smallest: [ ... ]</code>
            <code>}</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Достоинства</h2>
        <ol>
            <li>Автогенерация тестовых случаев</li>
            <li class="next">Подбор граничных условий</li>
            <li class="next">Точные причины ошибок</li>
        </ol>
    </section>

    <section class="slide">
        <h2>Недостатки</h2>
        <ol>
            <li>Нужно писать код типов</li>
            <li class="next">Нужно писать код теста</li>
            <li class="next">Сложно тестировать модули с памятью</li>
            <li class="next">Сложно генерировать неизбыточные модели</li>
        </ol>
    </section>

    <section class="slide cover">
        <img src="pictures/7.jpg" alt="" class="cover h">	
    </section>

    <section class="slide">
        <h2>Пользователь</h2>
        <ol>
            <li>ФИО</li>
            <li>Права доступа</li>
            <li><mark>Ранг</mark> // gen.oneOf(["Новичок", "Писатель" ...])</li>
            <li>Статьи</li>
            <ol>
                <li>Название</li>
                <li>Текст</li>
                <li>Оценка</li>
            </ol>
        </ol>
    </section>

    <section class="slide">
        <h2>Пользователь</h2>
        <ol>
            <li>ФИО</li>
            <li>Права доступа</li>
            <li><mark>Ранг</mark> // gen.oneOf(["Новичок", "Писатель" ...])</li>
            <li><mark style="background: #c00;color: #fff">Статьи</mark></li>
            <ol>
                <li>Название</li>
                <li>Текст</li>
                <li>Оценка</li>
            </ol>
        </ol>
    </section>

    <section class="slide">
        <h2>Решение</h2>
        <ol>
            <li>gen.suchThat - фильтрация</li>
            <li>gen.then - преобразование</li>
        </ol>
    </section>

    <section class="slide">
        <h2>Фильтрация</h2>
        <pre>
            <code>let rightUser = user.suchThat(us => </code>
            <code>	return us.articles.length &gt; 10 || us.rank !== "Писатель";</code>
            <code>});</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Фильтрация</h2>
        <pre>
            <code>let rightUser = user.suchThat(us => </code>
            <code>	return <mark>us.articles.length &gt; 10</mark> || us.rank !== "Писатель";</code>
            <code>});</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Фильтрация</h2>
        <pre>
            <code>let rightUser = user.suchThat(us => </code>
            <code>	return us.articles.length &gt; 10 || <mark>us.rank !== "Писатель";</mark></code>
            <code>});</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Преобразование</h2>
        <pre>
            <code>let rightUser = user.then(us => </code>
            <code>	if (us.articles.length &lt; 10 && us.rank === "Писатель") {</code>
            <code>		<mark>us.articles = gen.array(article, { size: 11 })</mark></code>
            <code>	}</code>
            <code>	return us;</code>
            <code>});</code>
        </pre>
    </section>

    <section class="slide">
        <h2 class="shout">Эксперименты</h2>
    </section>

    <section class="slide">
        <h2>Части модульного теста</h2>
        <ol>
            <li>Код модуля</li>
            <li><mark>Входные данные</mark> - 50%</li>
            <li>Код теста</li>
        </ol>
    </section>

    <section class="slide">
        <h2>Части модульного теста</h2>
        <ol>
            <li>Код модуля</li>
            <li><mark>Входные данные</mark> - 100%</li>
            <li>Код теста</li>
        </ol>
    </section>

    <section class="slide">
        <h2 class="shout">Генерация типов из Typescript</h2>
    </section>

    <section class="slide">
        <h2>Получение информации о типах</h2>
        <ol>
            <li><a href="https://www.npmjs.com/package/ts-simple-ast">ts-simple-ast</a></li>
            <li><a href="https://www.npmjs.com/package/ts-type-info">ts-type-info</a></li>
            <li class="next"><a href="https://github.com/Microsoft/TypeScript/wiki/Using-the-Compiler-API">TS-Compiler-API</a></li>
        </ol>
    </section>

    <section class="slide black">
        <img src="pictures/7.png" alt="" class="cover w">
    </section>

    <section class="slide">
        <h2>Получение типов</h2>
        <pre>
            <code>let ts = require("ts-type-info");</code>
            <code>const result = ts.getInfoFromFiles(["./model.ts"]);</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Структура</h2>
        <ul>
            <li>Файлы</li>
            <ul>
                <li>Функции</li>
                <li>Интерфейсы</li>
                <li>Импорты / Экспорты</li>
                <li>Классы</li>
                <li>Типы</li>
                <li>Переменные</li>
                <li>Enum</li>
            </ul>
        </ul>
    </section>

    <section class="slide black">
        <img src="pictures/10.png" alt="" class="cover w">
    </section>

    <section class="slide">
        <h2>Генератор</h2>
        <ul>
            <li>Обход дерева</li>
            <li class="next">Конвертация типов: number -> gen.number</li>
            <li class="next">Оборачивание массивов: number[] -> gen.array([gen.number])</li>
            <li class="next">Оборачивание объектов: gen.object({ fio: gen.number })</li>
            <li class="next">Оборачивание Nullable: ?number -> gen.oneOf([gen.number, gen.undefined])</li>
            <li class="next">Разделение сложных типов: "A" | "B" -> gen.oneOf(["A", "B"])</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Части модульного теста</h2>
        <ol>
            <li>Код модуля</li>
            <li><mark>Входные данные</mark> - 100%</li>
            <li>Код теста</li>
        </ol>
    </section>

    <section class="slide">
        <h2>Части модульного теста</h2>
        <ol>
            <li>Код модуля</li>
            <li><mark>Входные данные</mark> - 100%</li>
            <li><mark>Код теста</mark> - 30% - 80%</li>
        </ol>
    </section>

    <section class="slide">
        <h2 class="shout">Reflect</h2>
    </section>

    <section class="slide">
        <h2 class="shout"><a href="https://www.npmjs.com/package/reflect-metadata">Reflect-metadata</a></h2>
    </section>

    <section class="slide">
        <h2>Достоинства</h2>
        <ol>
            <li>Много данных о типах и методах</li>
            <li>Используется в Angular 2+</li>
        </ol>
        <h2>Недостатки</h2>
        <ol>
            <li>Нужно писать декораторы</li>
        </ol>
    </section>

    <section class="slide">
        <h2 class="shout"><a href="https://github.com/Microsoft/TypeScript/wiki/Using-the-Compiler-API">TS-Compiler-API</a></h2>
    </section>

    <section class="slide">
        <h2>TS компилятор</h2>
        <pre>
            <code>let program = ts.createProgram(fileNames, options);</code>
            <code>let checker = program.getTypeChecker();</code>
            <code>ts.forEachChild(</code>
            <code>			program.getSourceFiles()[1],</code>
            <code>			node => visit(node, checker)</code>
            <code>);</code>
        </pre>
    </section>

    <section class="slide">
        <pre>
            <code>if (node.kind === ts.SyntaxKind.InterfaceDeclaration) {</code>
            <code>	let interface = {</code>
            <code>		name: node.symbol.name,</code>
            <code>		documentation: ts.displayPartsToString(</code>
            <code>			symbol.getDocumentationComment()),</code>
            <code>		type: checker.typeToString(</code>
            <code>			checker.getTypeOfSymbolAtLocation(</code>
            <code>				symbol, symbol.valueDeclaration))</code>
            <code>	}</code>
            <code>}</code>
        </pre>
    </section>

    <section class="slide">
        <h2>Достоинства</h2>
        <ol>
            <li>Все возможные данный о типах</li>
            <li>Данные из JSDoc</li>
            <li>Данные о публичных методах и типах аргументов</li>
        </ol>
        <h2>Недостатки</h2>
        <ol>
            <li>Сложность</li>
        </ol>
    </section>

    <section class="slide black">
        <img src="pictures/8.jpg" alt="" class="cover w">
    </section>

    <section class="slide">
        <h2 class="shout">Вопросы</h2>
    </section>
    
    <div class="progress"></div>
    <script src="../shower/shower.min.js"></script>
</body>
</html>
